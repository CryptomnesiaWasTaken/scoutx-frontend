(this.webpackJsonpfb=this.webpackJsonpfb||[]).push([[7],{165:function(e,t,n){"use strict";var c=n(7),s=n(3),r=n.n(s),i=n(5),a=n(1),o=n(16),u=(n(169),n(174),n(172)),j=n(173),l=n(2),d=Object(a.forwardRef)((function(e,t){var n=e.setValue,s=Object(a.useRef)();Object(a.useImperativeHandle)(t,(function(){return{close:function(){return d(!1)}}}));var r=Object(a.useState)(!1),i=Object(c.a)(r,2),o=i[0],d=i[1];return Object(a.useEffect)((function(){var e=s.current,t=function(e){n((function(t){return t+e.detail.unicode}))};return e.addEventListener("emoji-click",t),function(){e.removeEventListener("emoji-click",t)}}),[n]),Object(l.jsxs)("div",{className:"emoji-picker",children:[Object(l.jsx)("div",{className:"opener",onClick:function(){return d((function(e){return!e}))},children:o?Object(l.jsx)(u.b,{}):Object(l.jsx)(j.a,{})}),Object(l.jsx)("div",{className:o?"picker open":"picker",children:Object(l.jsx)("emoji-picker",{ref:s})})]})}));t.a=function(e){var t=e.placeholder,n=e.handler,s=e.showEmoji,u=e.initialValue,j=void 0===u?"":u,b=function(){var e=Object(i.a)(r.a.mark((function e(t){var c;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),null===(c=v.current)||void 0===c||c.close(),O.trim()&&n(O.trim()),m("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=Object(a.useState)(j),f=Object(c.a)(h,2),O=f[0],m=f[1],v=Object(a.useRef)();return Object(a.useEffect)((function(){m(j)}),[j]),Object(l.jsxs)("form",{className:"input__box",onSubmit:b,children:[s&&Object(l.jsx)(d,{setValue:m,ref:v}),Object(l.jsx)("input",{type:"text",placeholder:t,value:O,onChange:function(e){return m(e.target.value)},onFocus:function(){var e;return null===(e=v.current)||void 0===e?void 0:e.close()}}),Object(l.jsx)("button",{type:"submit","aria-label":"submit",children:Object(l.jsx)("img",{src:o.n,alt:"send"})})]})}},166:function(e,t,n){"use strict";var c=n(7),s=n(1),r=n(16),i=(n(170),n(2));t.a=function(e){var t=e.options,n=e.id,a=void 0===n?"":n,o=Object(s.useState)(!1),u=Object(c.a)(o,2),j=u[0],l=u[1];Object(s.useEffect)((function(){var e=function(e){e.target.id!=="options"+a&&e.target.id!=="options__icon"+a&&l(!1)};return document.body.addEventListener("click",e),function(){return document.body.removeEventListener("click",e)}}),[a]);return Object(i.jsxs)("div",{className:"options",id:"options"+a,onClick:function(){return l((function(e){return!e}))},children:[Object(i.jsx)("img",{src:r.l,alt:"options",className:"options__icon",id:"options__icon"+a}),Object(i.jsx)("ul",{className:j?"show":"",children:Object.entries(t).map((function(e,t){var n=Object(c.a)(e,2),s=n[0],r=n[1];return Object(i.jsx)("li",{onClick:function(){return function(e){l(!1),e()}(r)},children:s},t)}))})]})}},167:function(e,t,n){"use strict";var c=n(7),s=n(1),r=n(48),i=(n(171),n(2)),a=function(e){var t=e.show,n=e.toggleShow,c=e.text,s=e.onSuccess;return Object(i.jsx)(r.a,{show:t,onClose:n,children:Object(i.jsxs)("div",{className:"confirmation",children:[Object(i.jsx)("h2",{children:c}),Object(i.jsxs)("div",{className:"btn-group",children:[Object(i.jsx)("button",{onClick:n,children:"Cancel"}),Object(i.jsx)("button",{className:"danger",onClick:function(){n(),s()},children:"Yes, I'm sure"})]})]})})};t.a=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Are Your sure ?",n=Object(s.useState)(!1),r=Object(c.a)(n,2),o=r[0],u=r[1],j=function(){return u(!o)},l=Object(i.jsx)(a,{show:o,onSuccess:e,text:t,toggleShow:j});return{toggleShow:j,Confirmation:l}}},168:function(e,t,n){"use strict";var c=["January","February","March","April","May","June","July","August","September","October","November","December"];t.a=function(e){if(!e)return"";var t=new Date(e);return t="".concat(t.getDate()," ").concat(c[t.getMonth()]," ").concat(t.getFullYear())}},169:function(e,t,n){},170:function(e,t,n){},171:function(e,t,n){},179:function(e,t,n){},180:function(e,t,n){},182:function(e,t,n){"use strict";var c=n(3),s=n.n(c),r=n(5),i=n(1),a=n(23),o=n(10),u=n(30),j=n(168),l=(n(179),n(2)),d=function(e){var t,n,c=e.message,s=e.index,r=e.messages,i=new Date,a=new Date(c.createdAt),o=r[s-1]&&new Date(null===(t=r[s-1])||void 0===t?void 0:t.createdAt),u=i.getDate()-a.getDate(),d=Object(j.a)(a),b=1===u?"YESTERDAY":0===u?"TODAY":d,h=!o||a.getDate()-o.getDate()>0,f=2===c.text.length&&!c.text.match(/\w/);return Object(l.jsxs)(l.Fragment,{children:[h&&Object(l.jsx)("h4",{children:b}),Object(l.jsx)("div",{className:c.send?"chat__sent":"chat__recieve",children:Object(l.jsxs)("p",{className:f?"emoji message":"message",children:[c.text,(null===(n=r[s+1])||void 0===n?void 0:n.send)!==c.send&&Object(l.jsx)("span",{className:"time",children:"".concat(a.getHours(),":").concat(a.getMinutes()>9?a.getMinutes():"0"+a.getMinutes())})]})})]})},b=n(165),h=n(16),f=(n(180),n(166)),O=n(167);t.a=function(){var e,t=Object(o.c)((function(e){return e})),n=t.user.id,c=t.message,j=c.messages,m=c.conversationID,v=c.to,g=c.chats,x=t.socket.socket,p=t.users.usersOnline,_=(null===g||void 0===g||null===(e=g.find((function(e){return e._id===m})))||void 0===e?void 0:e.userDetails)||{},w=Object(a.a)(),N=Object(o.b)(),k=Object(i.useRef)();Object(i.useEffect)((function(){k.current&&(k.current.scrollTop=k.current.scrollHeight)}),[j]);var D=function(){var e=Object(r.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.emit("send message",t,v,m,n),N(Object(u.a)({text:t,send:!0})),N(Object(u.j)({id:v,lastMessage:t,customFetch:w}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=Object(O.a)((function(){x.emit("delete chat",m,v),N(Object(u.e)(m))}),"Are you sure, you want to delete this chat"),y=S.Confirmation,C=S.toggleShow,E=Object(O.a)((function(){x.emit("clear chat",m,v),N(Object(u.b)({conversationID:m}))}),"Are you sure, you want to clear this chat"),A=E.Confirmation,I={"Delete Chat":C,"Clear Chat":E.toggleShow};return Object(l.jsx)("section",{className:"chat__page__messenger",children:m?Object(l.jsxs)(l.Fragment,{children:[y,A,Object(l.jsxs)("header",{children:[Object(l.jsx)("img",{src:_.profileImage||h.f,alt:"chatIcon",className:"chat__page__dp"}),Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:_.name}),p.some((function(e){return e.id===_._id}))&&Object(l.jsx)("p",{children:"Online"})]}),Object(l.jsx)(f.a,{options:I})]}),Object(l.jsx)("main",{ref:k,children:Object(l.jsx)("div",{className:"messenger",children:j.map((function(e,t,n){return Object(l.jsx)(d,{message:e,index:t,messages:n},t)}))})}),Object(l.jsx)("footer",{children:Object(l.jsx)(b.a,{placeholder:"Type a message...",handler:D,showEmoji:!0})})]}):Object(l.jsx)("h4",{children:"Select a conversation"})})}},199:function(e,t,n){},200:function(e,t,n){},206:function(e,t,n){"use strict";n.r(t);n(1);var c=n(10),s=n(16),r=n(30),i=n(6),a=n(23),o=n(56),u=(n(199),n(2)),j=function(e){var t=e.chat,n=t.userDetails,j=Object(c.c)((function(e){return e})),l=j.message.conversationID,d=j.users.usersOnline,b=j.user.id,h=l===t._id,f=Object(c.b)(),O=Object(a.a)(),m=Object(i.o)();return Object(u.jsxs)("article",{className:h?"active chatcard":"chatcard",onClick:function(){f(Object(r.i)(n._id)),f(Object(r.b)()),f(Object(r.g)(t._id)),window.innerWidth<801&&m("/chat/messenger"),O(o.c,{chatId:t._id}).then((function(e){f(Object(r.h)({messages:e.messages,id:b}))}))},children:[Object(u.jsx)("div",{className:d.some((function(e){return e.id===n._id}))?"green chatcard__dp":"chatcard__dp",children:Object(u.jsx)("img",{src:n.profileImage||s.f,alt:"",className:"roundimage"})}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{children:n.name||"User"}),Object(u.jsx)("p",{children:t.lastMessage||"Send a hi..."})]})]})},l=n(182);n(200),t.default=function(){var e=Object(c.c)((function(e){return e})).message.chats;return Object(u.jsxs)("main",{className:"chat__page",children:[Object(u.jsx)("section",{className:"chat__page__cards",children:e.map((function(e){return Object(u.jsx)(j,{chat:e},e._id)}))}),Object(u.jsx)(l.a,{})]})}}}]);
//# sourceMappingURL=7.3285b180.chunk.js.map